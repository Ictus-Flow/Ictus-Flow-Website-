import React, { useState, useEffect, useRef } from 'react';
import { 
  Cpu, 
  BarChart3, 
  ShieldCheck, 
  Map, 
  Beaker, 
  Rocket, 
  HardHat, 
  Menu, 
  X, 
  ArrowRight, 
  CheckCircle2,
  Building2,
  ChevronRight,
  Mail,
  Linkedin,
  Twitter,
  Sparkles,
  Clock,
  Users,
  TrendingUp,
  BrainCircuit,
  Mic,
  FileText,
  AlertTriangle
} from 'lucide-react';

// --- CUSTOM HOOKS & UTILITIES ---

// Hook for Typewriter Effect
const useTypewriter = (text, speed = 50, delay = 500) => {
  const [displayText, setDisplayText] = useState('');
  const [started, setStarted] = useState(false);

  useEffect(() => {
    const startTimeout = setTimeout(() => setStarted(true), delay);
    return () => clearTimeout(startTimeout);
  }, [delay]);

  useEffect(() => {
    if (!started) return;
    let i = 0;
    const timer = setInterval(() => {
      if (i < text.length) {
        setDisplayText((prev) => text.substring(0, i + 1));
        i++;
      } else {
        clearInterval(timer);
      }
    }, speed);
    return () => clearInterval(timer);
  }, [text, speed, started]);

  return displayText;
};

// Hook for Counting Up Numbers
const useCounter = (end, duration = 2000, start = 0) => {
  const [count, setCount] = useState(start);
  const ref = useRef(null);
  const [hasStarted, setHasStarted] = useState(false);

  useEffect(() => {
    const observer = new IntersectionObserver(([entry]) => {
      if (entry.isIntersecting && !hasStarted) {
        setHasStarted(true);
      }
    }, { threshold: 0.5 });
    if (ref.current) observer.observe(ref.current);
    return () => observer.disconnect();
  }, [hasStarted]);

  useEffect(() => {
    if (!hasStarted) return;
    let startTime;
    const step = (timestamp) => {
      if (!startTime) startTime = timestamp;
      const progress = Math.min((timestamp - startTime) / duration, 1);
      setCount(Math.floor(progress * (end - start) + start));
      if (progress < 1) window.requestAnimationFrame(step);
    };
    window.requestAnimationFrame(step);
  }, [hasStarted, end, duration, start]);

  return { count, ref };
};

// Component for Scroll Reveal Animation
const RevealOnScroll = ({ children, className = "" }) => {
  const [isVisible, setIsVisible] = useState(false);
  const ref = useRef(null);

  useEffect(() => {
    const observer = new IntersectionObserver(([entry]) => {
      if (entry.isIntersecting) {
        setIsVisible(true);
        observer.disconnect(); // Only trigger once
      }
    }, { threshold: 0.1 });
    if (ref.current) observer.observe(ref.current);
    return () => observer.disconnect();
  }, []);

  return (
    <div 
      ref={ref} 
      className={`transition-all duration-1000 ease-out transform ${isVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'} ${className}`}
    >
      {children}
    </div>
  );
};

// Component for Magnetic Button
const MagneticButton = ({ children, className, onClick, href }) => {
  const ref = useRef(null);
  const [position, setPosition] = useState({ x: 0, y: 0 });

  const handleMouseMove = (e) => {
    const { clientX, clientY } = e;
    const { left, top, width, height } = ref.current.getBoundingClientRect();
    const x = (clientX - (left + width / 2)) * 0.3; // Magnetic strength
    const y = (clientY - (top + height / 2)) * 0.3;
    setPosition({ x, y });
  };

  const handleMouseLeave = () => {
    setPosition({ x: 0, y: 0 });
  };

  const Component = href ? 'a' : 'button';

  return (
    <Component
      ref={ref}
      href={href}
      onClick={onClick}
      onMouseMove={handleMouseMove}
      onMouseLeave={handleMouseLeave}
      style={{ transform: `translate(${position.x}px, ${position.y}px)` }}
      className={`relative transition-transform duration-200 ease-out ${className}`}
    >
      {children}
    </Component>
  );
};

// --- MAIN COMPONENTS ---

const Navigation = ({ isScrolled }) => {
  const [isOpen, setIsOpen] = useState(false);

  const navLinks = [
    { name: 'Services', href: '#services' },
    { name: 'Outcomes', href: '#outcomes' },
    { name: 'Solutions', href: '#solutions' },
    { name: 'Contact', href: '#contact' },
  ];

  return (
    <nav className={`fixed w-full z-50 transition-all duration-300 ${isScrolled ? 'bg-slate-950/60 backdrop-blur-xl border-b border-white/10 py-4 shadow-[0_8px_32px_0_rgba(0,0,0,0.37)]' : 'bg-transparent py-6'}`}>
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex justify-between items-center">
          <div className="flex items-center group cursor-pointer">
            <div className="w-10 h-10 rounded-lg flex items-center justify-center mr-3 relative overflow-hidden shadow-lg shadow-purple-500/20 group-hover:shadow-pink-500/40 transition-all ring-1 ring-white/20">
              <div className="absolute inset-0 bg-gradient-to-br from-pink-600/80 via-purple-600/80 to-indigo-600/80 blur-md"></div>
              <Cpu className="text-white w-6 h-6 relative z-10 drop-shadow-md" />
            </div>
            <span className="text-2xl font-bold text-white tracking-tight group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-r group-hover:from-pink-400 group-hover:via-purple-400 group-hover:to-indigo-400 transition-all">Ictus Flow</span>
          </div>

          {/* Desktop Nav */}
          <div className="hidden md:flex items-center space-x-8">
            {navLinks.map((link) => (
              <a key={link.name} href={link.href} className="text-slate-200 hover:text-white hover:drop-shadow-[0_0_5px_rgba(255,255,255,0.5)] transition-all text-sm font-bold tracking-wide uppercase">
                {link.name}
              </a>
            ))}
            <MagneticButton href="#contact" className="inline-flex items-center justify-center bg-white/10 hover:bg-white/20 border border-white/20 text-white px-6 py-2 rounded-full transition-colors font-bold text-sm backdrop-blur-md shadow-[0_0_20px_rgba(255,255,255,0.1)]">
              Get Started
            </MagneticButton>
          </div>

          {/* Mobile Menu Button */}
          <div className="md:hidden flex items-center">
            <button onClick={() => setIsOpen(!isOpen)} className="text-white hover:text-pink-400 transition-colors">
              {isOpen ? <X className="w-8 h-8" /> : <Menu className="w-8 h-8" />}
            </button>
          </div>
        </div>
      </div>

      {/* Mobile Nav */}
      {isOpen && (
        <div className="md:hidden bg-slate-950/95 border-t border-white/10 absolute w-full backdrop-blur-xl">
          <div className="px-4 pt-2 pb-8 space-y-4">
            {navLinks.map((link) => (
              <a 
                key={link.name} 
                href={link.href} 
                onClick={() => setIsOpen(false)}
                className="block text-slate-300 hover:text-pink-400 text-lg font-medium py-2"
              >
                {link.name}
              </a>
            ))}
          </div>
        </div>
      )}
    </nav>
  );
};

const Hero = () => {
  const [mousePos, setMousePos] = useState({ x: 0, y: 0 });
  const heroText = useTypewriter("Eliminating Site Waste", 50);

  const handleMouseMove = (e) => {
    const x = (e.clientX - window.innerWidth / 2) / 20;
    const y = (e.clientY - window.innerHeight / 2) / 20;
    setMousePos({ x, y });
  };

  return (
    <div className="relative bg-slate-950 pt-32 pb-20 lg:pt-48 lg:pb-32 overflow-hidden" onMouseMove={handleMouseMove}>
      {/* Parallax Background Blobs */}
      <div className="absolute top-0 left-0 w-full h-full overflow-hidden z-0 pointer-events-none">
         <div 
            className="absolute top-[-20%] right-[-10%] w-[800px] h-[800px] bg-indigo-600/40 rounded-full blur-[120px] mix-blend-screen transition-transform duration-100 ease-out"
            style={{ transform: `translate(${mousePos.x * -1}px, ${mousePos.y * -1}px)` }}
         ></div>
         <div 
            className="absolute bottom-[10%] left-[-10%] w-[600px] h-[600px] bg-purple-600/30 rounded-full blur-[120px] mix-blend-screen transition-transform duration-100 ease-out"
            style={{ transform: `translate(${mousePos.x * 1.5}px, ${mousePos.y * 1.5}px)` }}
         ></div>
         <div 
            className="absolute top-[30%] left-[20%] w-[400px] h-[400px] bg-pink-500/30 rounded-full blur-[100px] mix-blend-screen transition-transform duration-100 ease-out"
            style={{ transform: `translate(${mousePos.x * -0.5}px, ${mousePos.y * -0.5}px)` }}
         ></div>
         <div 
            className="absolute bottom-[-10%] right-[10%] w-[500px] h-[500px] bg-cyan-500/20 rounded-full blur-[100px] mix-blend-screen transition-transform duration-100 ease-out"
            style={{ transform: `translate(${mousePos.x * 0.8}px, ${mousePos.y * 0.8}px)` }}
         ></div>
      </div>

      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 text-center">
        <RevealOnScroll>
          <div className="inline-flex items-center px-4 py-2 rounded-full bg-white/5 border border-white/10 backdrop-blur-lg mb-8 hover:border-pink-500/50 transition-colors cursor-default shadow-[0_8px_32px_0_rgba(0,0,0,0.2)]">
            <span className="w-2 h-2 rounded-full bg-pink-500 mr-2 animate-ping"></span>
            <span className="text-pink-200 text-sm font-bold tracking-wide">SPECIALIZING IN SME CONSTRUCTION</span>
          </div>
        </RevealOnScroll>
        
        <div className="min-h-[200px] md:min-h-[240px] mb-8">
          <h1 className="text-5xl md:text-8xl font-extrabold text-white tracking-tight leading-tight drop-shadow-2xl">
            {heroText}
            <span className="animate-pulse text-pink-500">|</span>
            <br className="hidden md:block"/>
            <RevealOnScroll className="delay-1000">
                <span className="text-transparent bg-clip-text bg-gradient-to-r from-pink-400 via-orange-400 to-yellow-400 block mt-2">Through Intelligence.</span>
            </RevealOnScroll>
          </h1>
        </div>

        <RevealOnScroll className="delay-200">
          <p className="mt-6 text-xl text-indigo-100/90 max-w-3xl mx-auto mb-12 leading-relaxed font-medium drop-shadow-md">
            Ictus Flow operationalizes AI for small-to-medium construction firms. We replace wasted admin time with actionâ€”automating site diaries, RAMS analysis, and verbal instructions.
          </p>
        </RevealOnScroll>

        <RevealOnScroll className="delay-300">
          <div className="flex flex-col sm:flex-row justify-center gap-6 items-center">
            <MagneticButton href="#contact" className="inline-flex items-center justify-center px-8 py-4 border border-white/20 text-base font-bold rounded-xl text-white bg-white/10 hover:bg-white/20 backdrop-blur-md transition-colors shadow-[0_8px_32px_0_rgba(31,38,135,0.37)]">
              Eliminate Waste Now
              <ArrowRight className="ml-2 w-5 h-5" />
            </MagneticButton>
            <MagneticButton href="#outcomes" className="inline-flex items-center justify-center px-8 py-4 border border-indigo-500/30 bg-slate-900/40 text-base font-bold rounded-xl text-indigo-100 hover:bg-indigo-900/40 transition-colors hover:border-pink-500/50 hover:text-white hover:shadow-[0_0_20px_rgba(236,72,153,0.2)] backdrop-blur-md">
              See The Outcomes
            </MagneticButton>
          </div>
        </RevealOnScroll>
      </div>
    </div>
  );
};

// NEW: Outcomes Section
const Outcomes = () => {
  const { count: hoursSaved, ref: refHours } = useCounter(1200); // Example: Hours saved per year
  const { count: staffTrained, ref: refStaff } = useCounter(450); // Staff trained
  const { count: efficiency, ref: refEff } = useCounter(35); // Efficiency %
  const { count: strategy, ref: refStrat } = useCounter(15); // Hours gained for strategy/week

  const stats = [
    { 
      label: "Admin Hours Saved / Yr", 
      value: hoursSaved, 
      ref: refHours, 
      suffix: "+",
      icon: Clock,
      color: "from-cyan-500 to-blue-500"
    },
    { 
      label: "Site Staff Upskilled", 
      value: staffTrained, 
      ref: refStaff, 
      suffix: "",
      icon: Users,
      color: "from-purple-500 to-pink-500"
    },
    { 
      label: "Efficiency Gain", 
      value: efficiency, 
      ref: refEff, 
      suffix: "%",
      icon: TrendingUp,
      color: "from-emerald-500 to-teal-500"
    },
    { 
      label: "Strategy Time / Wk", 
      value: strategy, 
      ref: refStrat, 
      suffix: "hrs",
      icon: BrainCircuit,
      color: "from-amber-500 to-orange-500"
    }
  ];

  return (
    <section id="outcomes" className="py-24 bg-slate-950 relative">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <RevealOnScroll>
          <div className="text-center mb-16">
            <h2 className="text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-cyan-400 font-black tracking-widest uppercase text-sm mb-3">TANGIBLE RESULTS</h2>
            <h3 className="text-4xl md:text-5xl font-bold text-white">Measuring What Matters</h3>
            <p className="mt-4 text-xl text-slate-300 max-w-2xl mx-auto">
              We don't just implement software; we buy you back your most valuable asset: Time.
            </p>
          </div>
        </RevealOnScroll>

        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          {stats.map((stat, idx) => (
            <RevealOnScroll key={idx} className={`delay-[${idx * 100}ms]`}>
              <div className="bg-white/5 backdrop-blur-xl border border-white/10 rounded-3xl p-8 flex flex-col items-center justify-center text-center hover:bg-white/10 transition-colors group">
                <div className={`w-16 h-16 rounded-2xl flex items-center justify-center mb-6 bg-gradient-to-br ${stat.color} shadow-lg opacity-90 group-hover:opacity-100 group-hover:scale-110 transition-all`}>
                  <stat.icon className="w-8 h-8 text-white" />
                </div>
                <div className="text-5xl font-black text-white mb-2" ref={stat.ref}>
                  {stat.value}{stat.suffix}
                </div>
                <div className="text-slate-400 font-medium uppercase tracking-wide text-sm">
                  {stat.label}
                </div>
              </div>
            </RevealOnScroll>
          ))}
        </div>
      </div>
    </section>
  );
};

// HYBRID "NEON GLASS" CARD
const ServiceCard = ({ icon: Icon, title, description, items, colorClass, borderClass, shadowColor }) => {
  const [isActive, setIsActive] = useState(false);

  return (
    <div 
      className="group h-[450px] w-full cursor-pointer relative"
      onClick={() => setIsActive(!isActive)}
    >
        {/* --- FRONT FACE --- */}
        <div className={`absolute inset-0 w-full h-full transition-all duration-700 ease-[cubic-bezier(0.4,0,0.2,1)] ${isActive ? 'opacity-0 blur-xl scale-90 pointer-events-none' : 'opacity-100 blur-0 scale-100 z-10'}`}>
            <div className={`h-full w-full bg-slate-900/60 backdrop-blur-xl border ${borderClass} rounded-3xl p-8 flex flex-col items-center justify-center text-center shadow-[0_8px_32px_0_rgba(0,0,0,0.36)] hover:shadow-[0_8px_32px_0_rgba(var(--shadow-color),0.5)] ring-1 ring-white/5`}>
               <div className={`absolute inset-0 bg-gradient-to-br ${colorClass} opacity-30 rounded-3xl`}></div>
               <div className={`absolute top-0 right-0 -mt-10 -mr-10 w-40 h-40 bg-gradient-to-br ${colorClass} blur-[60px] rounded-full opacity-40`}></div>

               <div className={`w-24 h-24 rounded-3xl flex items-center justify-center mb-10 relative z-10 ring-1 ring-white/20 group-hover:scale-110 transition-transform duration-500 overflow-hidden shadow-[0_0_30px_${shadowColor}_inset]`}>
                 <div className={`absolute inset-0 bg-gradient-to-br ${colorClass} opacity-80 blur-xl transform scale-150`}></div>
                 <Icon className="w-10 h-10 text-white relative z-10 drop-shadow-[0_0_15px_rgba(255,255,255,0.6)]" />
               </div>
               
               <h3 className="text-3xl font-bold text-white relative z-10 mb-6 drop-shadow-md">{title}</h3>
               
               <div className="mt-auto relative z-10 flex items-center text-slate-300 text-sm font-bold tracking-widest uppercase animate-pulse">
                 <Sparkles className="w-4 h-4 mr-2" />
                 Tap to Materialize
               </div>
            </div>
        </div>

        {/* --- BACK FACE --- */}
        <div className={`absolute inset-0 w-full h-full transition-all duration-700 ease-[cubic-bezier(0.4,0,0.2,1)] ${isActive ? 'opacity-100 blur-0 scale-100 z-20' : 'opacity-0 blur-xl scale-110 pointer-events-none'}`}>
             <div className={`h-full w-full bg-slate-950/80 backdrop-blur-2xl border ${borderClass} rounded-3xl p-8 flex flex-col shadow-[0_8px_32px_0_rgba(0,0,0,0.5)] overflow-hidden relative`}>
                <div className={`absolute inset-0 bg-gradient-to-br ${colorClass} opacity-20`}></div>
                
                <div className="flex items-center mb-6 border-b border-white/10 pb-4 relative z-10">
                  <Icon className="w-6 h-6 text-white mr-3" />
                  <h3 className="text-xl font-bold text-white">{title}</h3>
                </div>

                <p className="text-slate-200 mb-6 leading-relaxed text-sm relative z-10 font-medium drop-shadow-sm">{description}</p>
                
                <ul className="space-y-3 relative z-10">
                  {items.map((item, idx) => (
                    <li key={idx} className="flex items-start text-slate-200 text-sm">
                      <CheckCircle2 className={`w-5 h-5 mr-3 shrink-0 text-white drop-shadow-[0_0_5px_${shadowColor}]`} />
                      {item}
                    </li>
                  ))}
                </ul>

                <div className="mt-auto pt-4 text-center relative z-10">
                  <span className="text-xs text-slate-400 uppercase tracking-wider flex items-center justify-center gap-2">
                    <Sparkles className="w-3 h-3" />
                    Tap to Dissolve
                  </span>
                </div>
             </div>
        </div>
    </div>
  );
};

const Services = () => {
  const offerings = [
    {
      icon: Cpu,
      title: "Introduction to AI",
      colorClass: "from-cyan-600 to-blue-700",
      shadowColor: "rgba(6,182,212,0.5)", 
      borderClass: "border-cyan-500/30 hover:border-cyan-400/60",
      description: "Demystifying artificial intelligence for your leadership and site teams. We cut through the jargon to explain what tools actually work on-site.",
      items: ["SME Briefings", "LLM Fundamentals", "Tool Selection Workshops"]
    },
    {
      icon: BarChart3,
      title: "AI Strategy Review",
      colorClass: "from-pink-600 to-rose-700",
      shadowColor: "rgba(236,72,153,0.5)", 
      borderClass: "border-pink-500/30 hover:border-pink-400/60",
      description: "We audit your current site admin workflow to identify where AI can eliminate paperwork and delivery the highest ROI.",
      items: ["Workflow Audit", "Admin Cost Analysis", "Competitor Benchmarking"]
    },
    {
      icon: ShieldCheck,
      title: "AI Governance",
      colorClass: "from-emerald-500 to-teal-700",
      shadowColor: "rgba(16,185,129,0.5)", 
      borderClass: "border-emerald-500/30 hover:border-emerald-400/60",
      description: "Ensuring your use of AI for RAMS and contracts is compliant and secure. We build frameworks that protect your liability.",
      items: ["Data Privacy", "Liability Frameworks", "Human-in-the-loop Protocols"]
    },
    {
      icon: Map,
      title: "AI Blueprinting",
      colorClass: "from-purple-600 to-violet-700",
      shadowColor: "rgba(168,85,247,0.5)", 
      borderClass: "border-purple-500/30 hover:border-purple-400/60",
      description: "Developing the technical roadmap to integrate Voice capture and analysis tools into your existing Project Management software.",
      items: ["Tech Stack Selection", "Integration Planning", "Resource Allocation"]
    },
    {
      icon: Beaker,
      title: "Pilot Implementation",
      colorClass: "from-orange-500 to-red-700",
      shadowColor: "rgba(249,115,22,0.5)", 
      borderClass: "border-orange-500/30 hover:border-orange-400/60",
      description: "Low-risk pilots on single sites to validate time-savings from Voice Diaries and RAMS analysis before company-wide rollout.",
      items: ["Single-Site Trial", "Agile Deployment", "Metric Validation"]
    },
    {
      icon: Rocket,
      title: "Full Implementation",
      colorClass: "from-yellow-500 to-amber-700",
      shadowColor: "rgba(245,158,11,0.5)", 
      borderClass: "border-yellow-500/30 hover:border-yellow-400/60",
      description: "Scaling successful pilots across all projects. Training site managers to use voice tools effectively.",
      items: ["Company-wide Rollout", "Site Manager Training", "Support & Monitoring"]
    }
  ];

  return (
    <section id="services" className="py-24 bg-slate-950 relative overflow-hidden">
      <div className="absolute top-0 right-0 w-1/2 h-1/2 bg-cyan-900/30 blur-[150px] rounded-full"></div>
      <div className="absolute bottom-0 left-0 w-1/2 h-1/2 bg-pink-900/30 blur-[150px] rounded-full"></div>
      
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <RevealOnScroll>
          <div className="text-center mb-16">
            <h2 className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-pink-400 font-black tracking-widest uppercase text-sm mb-3">OUR EXPERTISE</h2>
            <h3 className="text-4xl md:text-6xl font-bold text-white drop-shadow-lg">End-to-End AI Consultancy</h3>
            <p className="mt-4 text-xl text-slate-300 max-w-2xl mx-auto font-light">
              From the first workshop to the final site deployment, we guide your firm through the transition to <span className="text-white font-medium">intelligent operations</span>.
            </p>
          </div>
        </RevealOnScroll>
        
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {offerings.map((offer, index) => (
            <RevealOnScroll key={index} className={`delay-[${index * 100}ms]`}>
                <ServiceCard {...offer} />
            </RevealOnScroll>
          ))}
        </div>
      </div>
    </section>
  );
};

const ConstructionFocus = () => (
  <section id="solutions" className="py-24 bg-slate-950 relative overflow-hidden">
    <div className="absolute inset-0 bg-gradient-to-b from-slate-950 via-amber-950/10 to-slate-950"></div>
    
    <div className="absolute top-0 left-0 w-full h-4 bg-[repeating-linear-gradient(45deg,#78350f,#78350f_20px,transparent_20px,transparent_40px)] opacity-50"></div>
    <div className="absolute bottom-0 left-0 w-full h-4 bg-[repeating-linear-gradient(45deg,#78350f,#78350f_20px,transparent_20px,transparent_40px)] opacity-50"></div>

    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
      <div className="grid lg:grid-cols-2 gap-16 items-center">
        <RevealOnScroll>
          <div>
            <div className="inline-flex items-center px-4 py-2 rounded-full bg-white/5 border border-white/10 backdrop-blur-md mb-6 shadow-[0_8px_32px_0_rgba(245,158,11,0.1)] animate-pulse-slow">
              <HardHat className="w-5 h-5 text-amber-400 mr-2" />
              <span className="text-amber-200 text-sm font-black tracking-wide uppercase">ELIMINATING WASTED TIME</span>
            </div>
            <h2 className="text-5xl font-extrabold text-white mb-6 leading-tight">
              Building Smarter with <span className="text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-orange-500">Intelligent Tools.</span>
            </h2>
            <p className="text-amber-100/70 text-lg mb-8 leading-relaxed font-medium">
              We target the three biggest time-sinks for SME construction firms: RAMS paperwork, end-of-day site reporting, and disputes over verbal instructions.
            </p>
            
            <div className="space-y-6">
              {/* RAMS Analysis */}
              <div className="flex items-start group p-4 rounded-xl transition-all hover:bg-white/5 border border-transparent hover:border-white/5 backdrop-blur-sm">
                <div className="relative w-12 h-12 rounded-lg flex items-center justify-center mr-4 overflow-hidden ring-1 ring-amber-600/50 shadow-md shadow-amber-900/20 shrink-0">
                   <div className="absolute inset-0 bg-gradient-to-br from-amber-500/70 to-orange-600/70 blur-md"></div>
                   <AlertTriangle className="text-white w-6 h-6 relative z-10 drop-shadow-sm" />
                </div>
                <div>
                  <h4 className="text-white font-bold text-xl group-hover:text-amber-400 transition-colors">RAMS Analysis</h4>
                  <p className="text-slate-400 mt-1">Auto-scan Risk Assessments and Method Statements for compliance gaps in seconds, not hours.</p>
                </div>
              </div>

              {/* Voice Site Diaries */}
              <div className="flex items-start group p-4 rounded-xl transition-all hover:bg-white/5 border border-transparent hover:border-white/5 backdrop-blur-sm">
                <div className="relative w-12 h-12 rounded-lg flex items-center justify-center mr-4 overflow-hidden ring-1 ring-amber-600/50 shadow-md shadow-amber-900/20 shrink-0">
                   <div className="absolute inset-0 bg-gradient-to-br from-amber-500/70 to-orange-600/70 blur-md"></div>
                   <Mic className="text-white w-6 h-6 relative z-10 drop-shadow-sm" />
                </div>
                <div>
                  <h4 className="text-white font-bold text-xl group-hover:text-amber-400 transition-colors">Voice-Based Site Diaries</h4>
                  <p className="text-slate-400 mt-1">Site managers speak their daily logs. AI transcribes, summarizes, and files them instantly.</p>
                </div>
              </div>

              {/* Verbal Instructions */}
              <div className="flex items-start group p-4 rounded-xl transition-all hover:bg-white/5 border border-transparent hover:border-white/5 backdrop-blur-sm">
                <div className="relative w-12 h-12 rounded-lg flex items-center justify-center mr-4 overflow-hidden ring-1 ring-amber-600/50 shadow-md shadow-amber-900/20 shrink-0">
                   <div className="absolute inset-0 bg-gradient-to-br from-amber-500/70 to-orange-600/70 blur-md"></div>
                   <FileText className="text-white w-6 h-6 relative z-10 drop-shadow-sm" />
                </div>
                <div>
                  <h4 className="text-white font-bold text-xl group-hover:text-amber-400 transition-colors">Verbal Instruction Capture</h4>
                  <p className="text-slate-400 mt-1">Voice-to-form technology converts verbal site instructions into formal CVIs instantly to prevent disputes.</p>
                </div>
              </div>
            </div>
          </div>
        </RevealOnScroll>

        {/* INFINITE MARQUEE CONTAINER */}
        <RevealOnScroll className="delay-200">
          <div className="bg-white/5 backdrop-blur-xl rounded-3xl p-8 border border-white/10 shadow-[0_8px_32px_0_rgba(0,0,0,0.37)] relative overflow-hidden">
            <div className="absolute top-0 right-0 w-64 h-64 bg-amber-600/10 blur-[80px] rounded-full"></div>
            <h3 className="text-white font-black mb-10 text-center text-lg tracking-widest uppercase text-transparent bg-clip-text bg-gradient-to-r from-slate-200 to-slate-500">Trusted by Leaders</h3>
            
            {/* Marquee Effect */}
            <div className="relative w-full overflow-hidden">
              <div className="flex w-[200%] animate-marquee">
                {[1, 2].map((i) => (
                  <div key={i} className="flex w-1/2 justify-around items-center gap-12 px-6">
                    <div className="opacity-60 hover:opacity-100 transition-opacity"><span className="text-2xl font-black text-slate-300 tracking-tighter">APEX<span className="text-amber-600">BUILD</span></span></div>
                    <div className="opacity-60 hover:opacity-100 transition-opacity"><span className="text-2xl font-serif font-bold text-slate-300">Structura</span></div>
                    <div className="opacity-60 hover:opacity-100 transition-opacity flex items-center gap-2"><div className="w-5 h-5 bg-slate-500 transform rotate-45"></div><span className="text-2xl font-bold text-slate-300">CORE</span></div>
                    <div className="opacity-60 hover:opacity-100 transition-opacity"><span className="text-xl font-mono font-bold text-slate-300">IRON<span className="italic text-amber-700">CLAD</span></span></div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </RevealOnScroll>
      </div>
    </div>
  </section>
);

const CaseStudies = () => {
  const { count: count1, ref: ref1 } = useCounter(60);
  const { count: count2, ref: ref2 } = useCounter(90);
  const { count: count3, ref: ref3 } = useCounter(2);

  const cases = [
    {
      client: "Regional Construction Firm",
      title: "Automated RAMS Analysis",
      resultVal: count1,
      resultSuffix: "% Faster Compliance",
      desc: "Implemented an AI scanning tool to review 50+ RAMS documents weekly, highlighting safety gaps instantly.",
      theme: "blue",
      gradient: "from-blue-600 to-cyan-500",
      border: "hover:border-blue-500/50",
      shadow: "hover:shadow-blue-500/20",
      ref: ref1
    },
    {
      client: "SME Contractor",
      title: "Voice Site Diaries",
      resultVal: count2,
      resultSuffix: "% Admin Reduction",
      desc: "Site managers switched from typing to voice logs. Daily reporting compliance went from 40% to 100%.",
      theme: "amber",
      gradient: "from-amber-600 to-red-600",
      border: "hover:border-amber-500/50",
      shadow: "hover:shadow-amber-500/20",
      ref: ref2
    },
    {
      client: "Fit-out Specialist",
      title: "CVI Automation",
      resultVal: count3,
      resultSuffix: "hrs Saved / Week",
      desc: "Verbal instructions on site captured via voice and auto-emailed as formal CVI documents to clients.",
      theme: "purple",
      gradient: "from-purple-600 to-pink-600",
      border: "hover:border-purple-500/50",
      shadow: "hover:shadow-purple-500/20",
      ref: ref3
    }
  ];

  return (
    <section id="case-studies" className="py-24 bg-slate-950 relative">
      <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full h-full max-w-4xl max-h-96 bg-emerald-900/10 blur-[100px] rounded-full"></div>

      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
        <RevealOnScroll>
          <div className="flex flex-col md:flex-row justify-between items-end mb-12">
            <div>
               <h2 className="text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-cyan-400 font-black tracking-widest uppercase text-sm mb-2">CASE STUDIES</h2>
               <h3 className="mt-2 text-4xl md:text-5xl font-bold text-white">Proven Impact</h3>
            </div>
            <a href="#" className="hidden md:flex items-center px-6 py-3 rounded-full bg-white/5 border border-white/10 text-white font-bold hover:border-emerald-400/50 hover:bg-white/10 hover:shadow-[0_0_20px_rgba(52,211,153,0.2)] transition-all group backdrop-blur-md">
              View all projects <ChevronRight className="w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform text-emerald-400" />
            </a>
          </div>
        </RevealOnScroll>

        <div className="grid md:grid-cols-3 gap-8">
          {cases.map((study, idx) => (
            <RevealOnScroll key={idx} className={`delay-[${idx * 150}ms]`}>
              <div className={`bg-white/5 backdrop-blur-xl rounded-2xl overflow-hidden border border-white/10 flex flex-col group ${study.border} transition-all duration-500 hover:-translate-y-2 shadow-[0_8px_32px_0_rgba(0,0,0,0.37)]`}>
                <div className={`h-2 bg-gradient-to-r ${study.gradient} w-full opacity-80`}></div>
                <div className="p-8 flex-1 flex flex-col relative">
                  <div className={`absolute inset-0 bg-gradient-to-br ${study.gradient} opacity-0 group-hover:opacity-[0.05] transition-opacity duration-500`}></div>
                  
                  <div className="mb-6">
                     <span className="inline-block py-1 px-3 rounded bg-black/30 text-xs font-bold uppercase tracking-wider text-slate-400 group-hover:text-white transition-colors mb-3 backdrop-blur-md">{study.client}</span>
                     <h4 className="text-2xl font-bold text-white group-hover:text-transparent group-hover:bg-clip-text group-hover:bg-gradient-to-r group-hover:from-white group-hover:to-slate-300 transition-all">{study.title}</h4>
                  </div>
                  <p className="text-slate-300 text-sm mb-8 flex-1 leading-relaxed group-hover:text-white font-medium relative z-10">{study.desc}</p>
                  <div className="pt-6 border-t border-white/10 group-hover:border-white/20 relative z-10">
                    <p ref={study.ref} className={`bg-gradient-to-r ${study.gradient} bg-clip-text text-transparent font-black text-3xl opacity-90`}>
                      {study.resultVal}{study.resultSuffix}
                    </p>
                  </div>
                </div>
              </div>
            </RevealOnScroll>
          ))}
        </div>
        
        <div className="mt-12 md:hidden text-center">
           <a href="#" className="inline-flex items-center text-emerald-400 hover:text-emerald-300 font-bold transition-colors">
            View all projects <ChevronRight className="w-5 h-5 ml-1" />
          </a>
        </div>
      </div>
    </section>
  );
};

const Contact = () => {
  const [formState, setFormState] = useState('idle'); 

  const handleSubmit = (e) => {
    e.preventDefault();
    setFormState('submitting');
    setTimeout(() => {
      setFormState('success');
    }, 800);
  };

  return (
    <section id="contact" className="py-24 bg-slate-950 relative overflow-hidden">
      <div className="absolute inset-0 bg-gradient-to-br from-indigo-950/30 via-slate-950 to-purple-950/30"></div>
      <div className="absolute bottom-0 right-0 w-[800px] h-[800px] bg-purple-600/10 rounded-full blur-[120px]"></div>
      <div className="absolute top-10 left-10 w-[600px] h-[600px] bg-indigo-600/10 rounded-full blur-[120px]"></div>

      <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-10">
        <RevealOnScroll>
          <div className="bg-white/5 backdrop-blur-2xl p-8 md:p-12 rounded-[2rem] border border-white/10 shadow-[0_8px_32px_0_rgba(31,38,135,0.37)] relative overflow-hidden group min-h-[500px] flex flex-col justify-center">
             
             {/* SUCCESS MESSAGE LAYER */}
             <div className={`absolute inset-0 flex flex-col items-center justify-center p-8 transition-all duration-1000 ease-out ${formState === 'success' ? 'opacity-100 blur-0 scale-100 z-20' : 'opacity-0 blur-3xl scale-110 z-0 pointer-events-none'}`}>
                 <div className="w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6 shadow-[0_0_40px_rgba(16,185,129,0.3)] animate-bounce-slow relative overflow-hidden ring-1 ring-emerald-500/30">
                   <div className="absolute inset-0 bg-gradient-to-br from-emerald-500/50 to-teal-600/50 blur-md"></div>
                   <CheckCircle2 className="w-12 h-12 text-white/90 relative z-10" />
                 </div>
                 <h3 className="text-4xl font-black text-white mb-4 drop-shadow-lg">Message Received</h3>
                 <p className="text-emerald-100/80 text-lg max-w-md leading-relaxed">We've started the engine. Expect a secure transmission to your inbox within 24 hours.</p>
                 <button onClick={() => setFormState('idle')} className="mt-10 px-8 py-3 rounded-full border border-emerald-500/30 text-emerald-300 font-bold hover:bg-emerald-900/20 hover:border-emerald-400/50 hover:text-white transition-all tracking-wide backdrop-blur-sm">Send another</button>
             </div>

             {/* FORM LAYER */}
             <div className={`transition-all duration-700 ease-in-out relative z-10 ${formState === 'idle' ? 'opacity-100 blur-0 translate-y-0' : 'opacity-0 blur-xl -translate-y-10 pointer-events-none'}`}>
                 <h2 className="text-4xl md:text-6xl font-black text-white mb-6 drop-shadow-lg">Ready to optimize your flow?</h2>
                 <p className="text-indigo-100/70 mb-10 max-w-xl mx-auto text-lg">
                   Schedule a free 30-minute discovery call. We'll discuss your current infrastructure and identify immediate AI opportunities.
                 </p>
                 
                 <form onSubmit={handleSubmit} className="space-y-5 max-w-md mx-auto">
                   <div className="group">
                     <input 
                       type="email" 
                       required 
                       placeholder="Enter your work email" 
                       className="w-full px-6 py-4 bg-black/20 border border-white/10 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-pink-500/50 focus:border-white/20 transition-all group-hover:border-white/20 shadow-inner backdrop-blur-sm"
                     />
                   </div>
                   <div className="group">
                     <select className="w-full px-6 py-4 bg-black/20 border border-white/10 rounded-xl text-slate-300 focus:outline-none focus:ring-2 focus:ring-purple-500/50 focus:border-white/20 transition-all appearance-none cursor-pointer group-hover:border-white/20 shadow-inner backdrop-blur-sm">
                        <option className="bg-slate-950 text-slate-300">I'm interested in...</option>
                        <option className="bg-slate-950 text-slate-300">Strategy Review</option>
                        <option className="bg-slate-950 text-slate-300">Training Workshop</option>
                        <option className="bg-slate-950 text-slate-300">Pilot Implementation</option>
                        <option className="bg-slate-950 text-slate-300">General Inquiry</option>
                     </select>
                   </div>
                   <MagneticButton 
                     onClick={handleSubmit}
                     className="w-full bg-gradient-to-r from-indigo-600/80 via-purple-600/80 to-pink-600/80 hover:from-indigo-500 hover:via-purple-500 hover:to-pink-500 text-white font-bold text-lg py-5 rounded-xl transition-all flex items-center justify-center shadow-[0_10px_30px_rgba(147,51,234,0.2)] border border-white/10 backdrop-blur-md cursor-pointer"
                   >
                     {formState === 'submitting' ? 'Transmitting...' : 'Request Consultation'}
                   </MagneticButton>
                 </form>
             </div>

          </div>
        </RevealOnScroll>
      </div>
    </section>
  );
};

const Footer = () => (
  <footer className="bg-slate-950 py-12 border-t border-white/10 relative overflow-hidden">
    <div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-900 via-purple-900 to-pink-900 opacity-50"></div>
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center relative z-10">
      <div className="flex items-center mb-4 md:mb-0 group cursor-pointer">
        <div className="w-8 h-8 rounded-lg flex items-center justify-center mr-3 relative overflow-hidden shadow-md shadow-purple-900/20 group-hover:shadow-pink-900/30 transition-all ring-1 ring-white/5">
            <div className="absolute inset-0 bg-gradient-to-br from-pink-900/50 via-purple-900/50 to-indigo-900/50 blur-sm"></div>
            <Cpu className="text-white/70 group-hover:text-white/90 transition-colors w-5 h-5 relative z-10" />
        </div>
        <span className="text-xl font-bold text-slate-300 group-hover:text-white transition-colors tracking-tight">Ictus Flow</span>
      </div>
      
      <div className="text-slate-500 text-sm mb-4 md:mb-0 font-medium">
        &copy; {new Date().getFullYear()} Ictus Flow Consultancy.
      </div>

      <div className="flex space-x-6">
        <a href="#" className="text-slate-500 hover:text-pink-400 transition-colors transform hover:scale-110 hover:drop-shadow-[0_0_8px_rgba(236,72,153,0.4)]"><Linkedin className="w-5 h-5" /></a>
        <a href="#" className="text-slate-500 hover:text-cyan-400 transition-colors transform hover:scale-110 hover:drop-shadow-[0_0_8px_rgba(6,182,212,0.4)]"><Twitter className="w-5 h-5" /></a>
        <a href="#" className="text-slate-500 hover:text-indigo-400 transition-colors transform hover:scale-110 hover:drop-shadow-[0_0_8px_rgba(99,102,241,0.4)]"><Mail className="w-5 h-5" /></a>
      </div>
    </div>
  </footer>
);

const App = () => {
  const [isScrolled, setIsScrolled] = useState(false);

  useEffect(() => {
    const handleScroll = () => {
      setIsScrolled(window.scrollY > 20);
    };
    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  return (
    <div className="min-h-screen bg-slate-950 font-sans selection:bg-pink-900/50 selection:text-white overflow-x-hidden">
      <style>{`
        @keyframes marquee {
          0% { transform: translateX(0%); }
          100% { transform: translateX(-100%); }
        }
        .animate-marquee {
          animation: marquee 25s linear infinite;
        }
      `}</style>
      <Navigation isScrolled={isScrolled} />
      <Hero />
      <Outcomes />
      <Services />
      <ConstructionFocus />
      <CaseStudies />
      <Contact />
      <Footer />
    </div>
  );
};

export default App;